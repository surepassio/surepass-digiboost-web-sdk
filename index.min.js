(() => {
	
	(function () {
		window.DigiboostSdk = function ({gateway: p, token: f, onSuccess: l, onFailure: s, selector: u, style: a}) {
			let y = `https://digilocker-sdk.notbot.in/?gateway=${p}&type=digilocker&token=${f}&auth_type=web`,
				e = document.createElement("button");
			e.innerText = "Verify with DigiLocker";
			let g = {
				padding: "10px 20px",
				backgroundColor: "#613AF5",
				color: "white",
				border: "none",
				borderRadius: "6px",
				cursor: "pointer",
				width: "100%",
			};
			Object.assign(e.style, g), a && Object.assign(e.style, a);
			let d = !1;
			e.addEventListener("click", () => {
				let t = e.innerText;
				e.disabled = !0, e.innerText = "Verifying...", e.style.opacity = "0.7", e.style.cursor = "not-allowed";
				let i = window.open(y, "_blank"),
					o = setInterval(() => {(!i || i.closed) && (clearInterval(o), !d && typeof s == "function" && s("Tab closed by user"), e.disabled = !1, e.innerText = t, e.style.opacity = "1", e.style.cursor = "pointer")}, 1e3);
				window.addEventListener("message", function r(n) {n.origin === "https://digilocker-sdk.notbot.in" && (n.data?.type === "digilocker:complete" && (d = !0, typeof l == "function" && l(n.data.data), e.disabled = !1, e.innerText = t, e.style.opacity = "1", e.style.cursor = "pointer"), window.removeEventListener("message", r))})
			});

			function b(t, i, o = 10) {
				let r = 0, n = setInterval(() => {
					let c = document.querySelector(t);
					c ? (clearInterval(n), i(c)) : ++r >= o && (clearInterval(n), console.warn(`\u274C DigiLockerSDK: Could not find ${t} after ${o} attempts`), i(null))
				}, 500)
			}

			b(u, t => {t ? t.appendChild(e) : document.body.appendChild(e)})
		}
	})();
})();
